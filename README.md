This is the core code of the basic middleware, including caching, messaging, and sequence number generation
